<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Proxmox - RTFM</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../../css/rtfm.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">RTFM</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">SYN Shop Docs</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../tags/" class="nav-link">Tags</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Admins</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Access%20Control%20System/" class="dropdown-item">Access Control System</a>
</li>
                                    
<li>
    <a href="../Caddy%20and%20TLS%20certs/" class="dropdown-item">Caddy and TLS certs</a>
</li>
                                    
<li>
    <a href="../Synshop.org%20Hosting/" class="dropdown-item">Synshop.org Hosting</a>
</li>
                                    
<li>
    <a href="../Traffic-Light/" class="dropdown-item">Traffic Light Admin Guide</a>
</li>
                                    
<li>
    <a href="../c220/" class="dropdown-item">c220 and LXD</a>
</li>
                                    
<li>
    <a href="../docker/" class="dropdown-item">Docker (and Portainer)</a>
</li>
                                    
<li>
    <a href="../flatline/" class="dropdown-item">Flatline</a>
</li>
                                    
<li>
    <a href="../kiosk/" class="dropdown-item">Front Kiosk Display</a>
</li>
                                    
<li>
    <a href="../membership/" class="dropdown-item">membership website</a>
</li>
                                    
<li>
    <a href="../networking/" class="dropdown-item">Shop LAN &amp; WiFi</a>
</li>
                                    
<li>
    <a href="../pi-hole-stubby/" class="dropdown-item">Pi-Hole DNS</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Proxmox</a>
</li>
                                    
<li>
    <a href="../rtfm/" class="dropdown-item">rtfm</a>
</li>
                                    
<li>
    <a href="../synbackup/" class="dropdown-item">synbackup</a>
</li>
                                    
<li>
    <a href="../unifi/" class="dropdown-item">Unifi VM</a>
</li>
                                    
<li>
    <a href="../vpn/" class="dropdown-item">VPN</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Users</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../users/FAQ/" class="dropdown-item">FAQ</a>
</li>
                                    
<li>
    <a href="../../users/Local%20Resources/" class="dropdown-item">Local Resources</a>
</li>
                                    
<li>
    <a href="../../users/Logos/" class="dropdown-item">Logos</a>
</li>
                                    
<li>
    <a href="../../users/Mailing%20Lists/" class="dropdown-item">Mailing Lists</a>
</li>
                                    
<li>
    <a href="../../users/Online%20Resources/" class="dropdown-item">Online Resources</a>
</li>
                                    
<li>
    <a href="../../users/SYN%20Shop%20Tool%20List/" class="dropdown-item">SYN Shop Tool &amp; Equipment List</a>
</li>
                                    
<li>
    <a href="../../users/SYN%20Shop%20Vision/" class="dropdown-item">SYN Shop Vision</a>
</li>
                                    
<li>
    <a href="../../users/SYN%20Shop%20v1.0/" class="dropdown-item">SYN Shop v1.0</a>
</li>
                                    
<li>
    <a href="../../users/Table%20Saw/" class="dropdown-item">Delta Cabinet Table Saw</a>
</li>
                                    
<li>
    <a href="../../users/Waivers/" class="dropdown-item">Waivers</a>
</li>
                                    
<li>
    <a href="../../users/kiosk/" class="dropdown-item">Front Kiosk Display</a>
</li>
                                    
<li>
    <a href="../../users/media/" class="dropdown-item">Media</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Equipment</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../users/Equipment/Band%20Saw/" class="dropdown-item">Grizzly G0513ANV Band Saw</a>
</li>
            
<li>
    <a href="../../users/Equipment/Big%20Boi%20Laser%20Cutter/" class="dropdown-item">"Big Boi" Laser Cutter</a>
</li>
            
<li>
    <a href="../../users/Equipment/Consew%20230%20Industrial%20Sewing%20Machine/" class="dropdown-item">Consew 230 Industrial Sewing Machine</a>
</li>
            
<li>
    <a href="../../users/Equipment/Drill%20Press/" class="dropdown-item">Craftsman Professional 3/4 hp Drill Press</a>
</li>
            
<li>
    <a href="../../users/Equipment/F400-s/" class="dropdown-item">Fusion 3 F400-s</a>
</li>
            
<li>
    <a href="../../users/Equipment/First%20Child%20Laser%20Cutter/" class="dropdown-item">"First Child" Laser Cutter</a>
</li>
            
<li>
    <a href="../../users/Equipment/Jointer/" class="dropdown-item">8" Jointer</a>
</li>
            
<li>
    <a href="../../users/Equipment/Large%20Format%20Printer/" class="dropdown-item">Canon iPF6400SE Large Format Printer</a>
</li>
            
<li>
    <a href="../../users/Equipment/New%20Kid%20Laser%20Cutter/" class="dropdown-item">"New Kid" Laser Cutter</a>
</li>
            
<li>
    <a href="../../users/Equipment/Resin%20Printers/" class="dropdown-item">Resin Printers</a>
</li>
            
<li>
    <a href="../../users/Equipment/Retina%20Engrave/" class="dropdown-item">Retina Engrave</a>
</li>
            
<li>
    <a href="../../users/Equipment/ShopBot/" class="dropdown-item">ShopBot PRSstandard CNC 96-48</a>
</li>
            
<li>
    <a href="../../users/Equipment/Silhoutte%20Cameo/" class="dropdown-item">Silhoutte Cameo</a>
</li>
            
<li>
    <a href="../../users/Equipment/Surface%20Planer/" class="dropdown-item">Powermatic 14" Surface Planer</a>
</li>
            
<li>
    <a href="../../users/Equipment/Table%20Saw/" class="dropdown-item">Delta Cabinet Table Saw</a>
</li>
            
<li>
    <a href="../../users/Equipment/Track%20Saw/" class="dropdown-item">Grizzle PRO T33300 Track Saw</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Projects</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../users/Projects/555%20Contest%20-%20Gravity%20Detecting%2C%20Color%20Swirling%20Pingpong%20Balls/" class="dropdown-item">555 Contest - Gravity Detecting, Color Swirling Pingpong Balls</a>
</li>
            
<li>
    <a href="../../users/Projects/Do-nato/" class="dropdown-item">Do-nato</a>
</li>
            
<li>
    <a href="../../users/Projects/Shapeoko%20PCB%20Milling/" class="dropdown-item">Shapeoko PCB Milling</a>
</li>
            
<li>
    <a href="../../users/Projects/Traffic-Light/" class="dropdown-item">Traffic Light</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SYNShop3.0</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../users/SYNShop3.0/" class="dropdown-item">SYN Shop v3.0</a>
</li>
            
<li>
    <a href="../../users/SYNShop3.0/FAQ/" class="dropdown-item">We're officially moving!</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../pi-hole-stubby/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../rtfm/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/synshop/rtfm/edit/master/docs/admins/proxmox.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#proxmox" class="nav-link">Proxmox</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#overview" class="nav-link">Overview</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#install-hardware" class="nav-link">Install &amp; Hardware</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#downloading-a-new-iso" class="nav-link">Downloading a new ISO</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#creating-a-new-container" class="nav-link">Creating a new container</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#creating-a-new-vm" class="nav-link">Creating a new VM</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#nas-drives" class="nav-link">NAS Drives</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="proxmox">Proxmox<a class="headerlink" href="#proxmox" title="Permanent link"></a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link"></a></h2>
<p>A desktop tower with <a href="https://www.proxmox.com/en/">Proxmox</a> installed on it was deployed to: </p>
<ul>
<li>Be a future home for all LXD containers on the c220 so the c220 can eventually be retired</li>
<li>Host future projects that need a VM at the shop</li>
<li>Host 4 x 12TB drives to serve media to the shop LAN</li>
</ul>
<p>All Proxmox admin is done through the web GUI at <a href="https://proxmox.synshop.net">https://proxmox.synshop.net</a>, which is reverse proxied through the Caddy server to have a valid TLS cert.  The baremetal IP is <code>10.0.40.16</code>, but of course the proxmox.synshop.net domain resolves to Caddy at <code>.29</code>.</p>
<p>To log into the server, be on the VPN or at the shop, go the <a href="https://proxmox.synshop.net">URL</a> and use the <code>proxmox</code> credentials from the shop password database.</p>
<h2 id="install-hardware">Install &amp; Hardware<a class="headerlink" href="#install-hardware" title="Permanent link"></a></h2>
<p>Proxmox was installed with these 7 drives:</p>
<ul>
<li>256GB Apple branded 2.5" SATA SSD: boot drive for prox mox (<code>/dev/sdc</code>) . Shows as <code>local-lvm</code> or <code>pve</code> in Proxmox</li>
<li>256GB NVMe SSD: data volume for all active VMS (<code>/dev/nvme0n1</code>). Shows as <code>local</code> or <code>vmdata</code> in Proxmox.</li>
<li>3TB SATA: Backup drive for all Proxmox data, VMs etc. (<code>/dev/sde</code>). Shows as <code>backups</code> in Proxmox.</li>
<li>4 x 12TB SATA: TBD use for NAS/Media sharing (<code>/dev/sda</code>, <code>/dev/sdb</code>, <code>/dev/sdd</code> and <code>/dev/sdf</code> ). </li>
</ul>
<p>Here's the output of <code>lsblk</code>:</p>
<pre><code class="language-shell">root@proxmox:~# lsblk
NAME                        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
sda                           8:0    0  10.9T  0 disk /mnt/nas/ZTN19LH8
sdb                           8:16   0  10.9T  0 disk /mnt/nas/ZTN1AT71
sdc                           8:32   0 233.8G  0 disk 
├─sdc1                        8:33   0  1007K  0 part 
├─sdc2                        8:34   0     1G  0 part /boot/efi
└─sdc3                        8:35   0 232.8G  0 part 
  ├─pve-swap                252:0    0     8G  0 lvm  [SWAP]
  ├─pve-root                252:1    0  68.2G  0 lvm  /
  ├─pve-data_tmeta          252:2    0   1.4G  0 lvm  
  │ └─pve-data-tpool        252:6    0 137.8G  0 lvm  
  │   ├─pve-data            252:7    0 137.8G  1 lvm  
  │   └─pve-vz              252:8    0   230G  0 lvm  /mnt/nvme
  └─pve-data_tdata          252:3    0 137.8G  0 lvm  
    └─pve-data-tpool        252:6    0 137.8G  0 lvm  
      ├─pve-data            252:7    0 137.8G  1 lvm  
      └─pve-vz              252:8    0   230G  0 lvm  /mnt/nvme
sdd                           8:48   0  10.9T  0 disk /mnt/nas/ZTN1CWZL
sde                           8:64   1   2.7T  0 disk 
└─sde1                        8:65   1   2.7T  0 part /mnt/pve/backups
sdf                           8:80   1  10.9T  0 disk /mnt/nas/ZRT122RV
nvme0n1                     259:0    0 232.9G  0 disk 
└─nvme0n1p1                 259:1    0 232.9G  0 part 
  ├─vmdata-vm--100--disk--0 252:4    0    32G  0 lvm  
  └─vmdata-vm--101--disk--0 252:5    0    30G  0 lvm  
</code></pre>
<p>Within Proxmox, you can see the drives this way:</p>
<p><img alt="Screenshot of drives in the proxmox mox disks page" src="../images/proxmox.drives.png" /></p>
<h2 id="downloading-a-new-iso">Downloading a new ISO<a class="headerlink" href="#downloading-a-new-iso" title="Permanent link"></a></h2>
<p>To add a new  ISO so that you can create a VM with it later:</p>
<ol>
<li>Navigate to <code>local</code> storage on left</li>
<li>Click <code>ISO Images</code> in middle</li>
<li>click <code>Upload</code> button at top</li>
<li>Enter ISO URL and click <code>Download</code></li>
</ol>
<p><img alt="Screenshot of adding a new ISO with 4 arrows denoting order of steps" src="../images/new.iso.png" /></p>
<h2 id="creating-a-new-container">Creating a new container<a class="headerlink" href="#creating-a-new-container" title="Permanent link"></a></h2>
<ol>
<li>On the left, Click "Datacenter" and then "Proxmox"</li>
<li>In the upper right click "Create CT"</li>
<li>On the <code>General</code> screen fill out <code>hostname</code>, <code>password</code> and <code>confirm password</code>. Add your own <code>SSH Public key(s)</code> and then leave the rest default. <strong>Note</strong> - by default containers won't allow yout to SSH with a password, only SSHs keys</li>
<li>Click <code>Next</code></li>
<li>On the <code>Template</code> screen,  for <code>Storage</code> choose <code>local</code> and choose <code>Ubuntu</code> from the  <code>Template</code> drop down.</li>
<li>Click <code>Next</code></li>
<li>On the <code>Disks</code> screen,  for <code>Storage</code> choose <code>vmdata</code> and choose <code>30</code>  for  <code>Disk size (GiB)</code>.  leave the rest default.</li>
<li>Click <code>Next</code></li>
<li>On the <code>CPU</code> screen,  for <code>Cores</code> choose <code>2</code> and  leave the rest default.</li>
<li>Click <code>Next</code></li>
<li>On the <code>Memory</code> screen,  for <code>Memory</code> choose <code>2048</code> and  leave the rest default.</li>
<li>Click <code>Next</code></li>
<li>On the <code>Network</code> screen,  for <code>IPv4/CIDR</code> choose an avail static IP.  For <code>Gateway</code> enter <code>10.0.40.1</code>  and  leave the rest default.</li>
<li>Click <code>Next</code></li>
<li>On the <code>DNS</code> screen,  for <code>DNS Servers</code> enter enter <code>10.0.40.66</code></li>
<li>Click <code>Next</code></li>
<li>On the final <code>Confirm</code> screen choose <code>Start after created</code> and click <code>Finish</code></li>
<li>After the container is created choose it from the list on the right, click on <code>Options</code> and double click <code>Start at boot</code> to be checked</li>
<li>Go to "Datacenter" on the left navigation, click "Backup" in the main pannel, double click the one listed backup job - add your new container to be backed up nightly</li>
</ol>
<h2 id="creating-a-new-vm">Creating a new VM<a class="headerlink" href="#creating-a-new-vm" title="Permanent link"></a></h2>
<ol>
<li>On the left, Click "Datacenter" and then "Proxmox"</li>
<li>In the upper right click "Create VM"</li>
<li>On the <code>General</code> screen leave <code>Node</code> and <code>VM ID</code> with the default value.  Enter a descriptive, but short name in <code>Name</code>.</li>
<li>Check the <code>Advanced</code> check box near the bottom and check <code>Start at boot</code> box to ensure the VM is booted when ever the system reboots.</li>
<li>Click <code>Next</code></li>
<li>On the <code>OS</code> screen, if you're installing from an ISO,  for <code>Storage</code> choose <code>local</code> and choose the ISO in the <code>ISO image</code> drop down.</li>
<li>Leave all other fields with default values and click <code>Next</code></li>
<li>On the <code>System</code> screen, leave all fields with default values and click <code>Next</code></li>
<li>On the <code>Disks</code> screen, choose <code>vmdata</code> for <code>Storage</code> which uses the "256GB NVMe SSD" device for very fast data.</li>
<li>If you need more or less storage than <code>32</code>, update the <code>Disk Size (GiB)</code> as needed.</li>
<li>Leave all other fields with default values and click <code>Next</code></li>
<li>On the <code>CPU</code> screen, choose <code>2</code> for <code>cores</code> and leave all the rest default and click <code>Next</code></li>
<li>On the <code>Memory</code> screen, add more or less RAM than <code>2GB</code> as needed. Leave all the rest default and click <code>Next</code></li>
<li>On the <code>Network</code> screen, leave all fields with default values and click <code>Next</code> (be sure to set a static IP in the VM after it boots)</li>
<li>On the <code>Confirm</code> screen, review all data and click <code>Finish</code> </li>
<li>Click on the right side of the screen where your new VM shows up as <code>NUMBER (Name)</code> eg <code>102 (truenas)</code></li>
<li>Click <code>Console</code> and choose <code>Start now</code></li>
<li>Go to "Datacenter" on the left navigation, click "Backup" in the main pannel, double click the one listed backup job - add your new VM to be backed up nightly</li>
</ol>
<h2 id="nas-drives">NAS Drives<a class="headerlink" href="#nas-drives" title="Permanent link"></a></h2>
<p>These 4 x 12TB SATA drives have been provisioned a few different ways, none of which have worked out.  </p>
<h3 id="truenas">TrueNAS<a class="headerlink" href="#truenas" title="Permanent link"></a></h3>
<p>Originally it was thought that having some redundancy was helpful, so a 32TGB ZFS Raidz1 was created by passing them through raw to TrueNAS.  Something like:</p>
<ol>
<li>Create a TrueNAS install in a new VM, but don't provision any storage.  Resulting VM ID was <code>102</code>. </li>
<li>
<p>As <code>root</code> on the Proxmox machine (via web Shell), find the raw device IDs:</p>
<p><pre>root@proxmox:~# ls -al /dev/disk/by-id | egrep 'ZTN1CWZL|ZTN1AT71|ZTN19LH8|ZRT122RV'
lrwxrwxrwx 1 root root   9 Feb  4 15:18 ata-ST12000VN0008-2PH103_ZTN19LH8 -&gt; ../../sda
lrwxrwxrwx 1 root root   9 Feb  4 15:08 ata-ST12000VN0008-2PH103_ZTN1AT71 -&gt; ../../sdb
lrwxrwxrwx 1 root root   9 Feb  4 15:16 ata-ST12000VN0008-2PH103_ZTN1CWZL -&gt; ../../sdd
lrwxrwxrwx 1 root root   9 Feb  4 15:10 ata-ST12000VN0008-2YS101_ZRT122RV -&gt; ../../sdf</pre></p>
</li>
<li>
<p>Still in the <code>root</code> shell, pass the raw devices into the TrueNAS VM which has ID <code>102</code>:</p>
<p><pre>qm set 102 -scsi1 /dev/disk/by-id/ata-ST12000VN0008-2PH103_ZTN19LH8
qm set 102 -scsi2 /dev/disk/by-id/ata-ST12000VN0008-2PH103_ZTN1AT71
qm set 102 -scsi3 /dev/disk/by-id/ata-ST12000VN0008-2PH103_ZTN1CWZL
qm set 102 -scsi4 /dev/disk/by-id/ata-ST12000VN0008-2YS101_ZRT122RV</pre></p>
</li>
<li>
<p>Reboot the TrueNAS VM to make sure it can see the new disks added to the VM.  </p>
</li>
<li>Use the TrueNAS web GUI to add the 4 drives to a ZFS Raidz1 volume</li>
</ol>
<h3 id="mergerfs">MergerFS<a class="headerlink" href="#mergerfs" title="Permanent link"></a></h3>
<p>Realizing that we wanted full 48TB with no redundancy, we thought that <a href="https://github.com/trapexit/mergerfs">MergerFS</a> would work better. The TrueNAS VM was deleted and then the following was done:</p>
<ol>
<li>Format the 4 drives as <code>ext4</code> (do this once per drive ID): <code>mkfs.ext4 /dev/disk/by-id/ata-ST12000VN0008-2YS101_ZRT122RV</code></li>
<li>Create mount directories: <code>mkdir /mnt/nas;mkidr /mnt/nas/ZRT122RV;mkdir /mnt/nas/ZTN1CWZL;/mnt/nas/ZTN1AT71;/mnt/nas/ZTN19LH8</code></li>
<li>
<p>Add an <code>/etc/fstab</code> entry that mounted all 4 in <code>/mnt/nas</code> and then user <code>mergfs</code> to mount all 4 in one line to <code>/mnt/nas-all</code>:</p>
<p><pre>
/dev/disk/by-id/ata-ST12000VN0008-2YS101_ZRT122RV  /mnt/nas/ZRT122RV    ext4    defaults     0   0
/dev/disk/by-id/ata-ST12000VN0008-2PH103_ZTN19LH8  /mnt/nas/ZTN19LH8    ext4    defaults     0   0
/dev/disk/by-id/ata-ST12000VN0008-2PH103_ZTN1AT71  /mnt/nas/ZTN1AT71    ext4    defaults     0   0
/dev/disk/by-id/ata-ST12000VN0008-2PH103_ZTN1CWZL  /mnt/nas/ZTN1CWZL    ext4    defaults     0   0</p>
<p>/mnt/nas/* /mnt/nas-all fuse.mergerfs defaults,nonempty,allow_other,use_ino,cache.files=off,moveonenospc=true,category.create=mfs,dropcacheonclose=true,minfreespace=250G,fsname=mergerfs 0 0</pre></p>
</li>
<li>
<p>checking <code>df -h</code>, we can see this is working as expected:</p>
<p><pre>
root@proxmox:~# df -h|egrep 'Size|nas'
Filesystem            Size  Used Avail Use% Mounted on
/dev/sdf               11T   36K   11T   1% /mnt/nas/ZRT122RV
/dev/sda               11T   36K   11T   1% /mnt/nas/ZTN19LH8
/dev/sdb               11T   36K   11T   1% /mnt/nas/ZTN1AT71
/dev/sdd               11T   40K   11T   1% /mnt/nas/ZTN1CWZL
mergerfs               44T  148K   42T   1% /mnt/nas-all</pre>
5. This was then added to Proxmox as a <code>Directory</code>, but this looks to not be the best path forward. Proxmox then tried to format all 48TB as another drive or something?  Likely we want to undue all this and pass the raw devices into a new NAS based VM that can provision MergerFS volume in there and then share that out to the LAN.</p>
</li>
</ol>
<p>Next steps TBD!</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../js/rtfm.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
